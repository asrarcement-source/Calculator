<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cement Kiln Design Calculator</title>
    <link rel="stylesheet" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Additional custom styles for kiln design calculator */
        .kpi-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .kpi-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
            color: var(--primary-color);
        }
        
        .kpi-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .good { color: var(--success-color); }
        .fair { color: var(--warning-color); }
        .poor { color: var(--danger-color); }
        
        .chart-container {
            height: 400px;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        .recommendations {
            background: #fff9e6;
            border-left: 5px solid var(--warning-color);
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .ai-analysis {
            background: #f0f8ff;
            border-left: 5px solid var(--primary-color);
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .results-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        /* Splash Screen Styles */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
            opacity: 1;
            transition: opacity 1s ease-out;
        }
        
        .splash-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .splash-screen h1 {
            font-size: 36px;
            margin-bottom: 10px;
            font-weight: 600;
            text-align: center;
        }
        
        .splash-screen p {
            font-size: 18px;
            font-style: italic;
            text-align: center;
        }
        
        .splash-screen .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-top: 30px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Print Header and Footer */
        .print-header {
            display: none;
        }
        
        .print-footer {
            display: none;
        }
        
        @media print {
            @page {
                size: A4;
                margin: 0.75in;
            }
            
            .print-header, .print-footer {
                display: block;
                position: fixed;
                left: 0;
                right: 0;
                background: white;
                z-index: 100;
                padding: 10px 0.75in;
            }
            
            .print-header {
                top: 0;
                height: 70px;
                border-bottom: 2px solid var(--primary-color);
                display: flex;
                justify-content: space-between;
                align-items: center;
                font-size: 10pt;
            }
            
            .print-footer {
                bottom: 0;
                height: 30px;
                border-top: 1px solid var(--border-color);
                text-align: center;
                font-size: 9pt;
                color: var(--text-secondary);
                line-height: 30px;
            }
            
            body {
                padding-top: 80px;
                padding-bottom: 40px;
                font-size: 12pt;
            }
            
            .no-print {
                display: none !important;
            }
            
            .card {
                box-shadow: none;
                border: 1px solid var(--border-color);
                page-break-inside: avoid;
            }
            
            .chart-container {
                page-break-inside: avoid;
            }
        }
        
        /* Custom styles for this calculator */
        .developer-info {
            background: var(--gradient-primary);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        .developer-info h3 {
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .developer-info p {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .api-status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .api-status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .api-status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div>
            <h1 data-en="Loading Calculator... Please Wait" data-ar="جاري تحميل الحاسبة... يرجى الانتظار">Loading Calculator... Please Wait</h1>
            <p data-en="We're preparing everything for you ⚡" data-ar="نحن نعد كل شيء لك ⚡" style="margin-top: 15px; font-size: 16px; opacity: 0.9;">We're preparing everything for you ⚡</p>
            <div class="loader" style="width: 80px; height: 80px;"></div>
        </div>
    </div>

    <!-- Print Header -->
    <div class="print-header">
        <div>
            <strong data-en="Cement Kiln Design Calculator" data-ar="حاسبة تصميم أفران الأسمنت">Cement Kiln Design Calculator</strong>
        </div>
        <div>
            <strong data-en="Confidential Report" data-ar="تقرير سري">Confidential Report</strong>
        </div>
    </div>

    <!-- Print Footer -->
    <div class="print-footer">
        <span data-en="Mr. Fadi M. Darwesh - QC & R&D Specialist - asrar.cement@gmail.com" data-ar="السيد فادي م. درويش - أخصائي ضمان الجودة والبحوث والتطوير - asrar.cement@gmail.com">Mr. Fadi M. Darwesh - QC & R&D Specialist - asrar.cement@gmail.com</span>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header no-print">
            <div class="header-content">
                <div class="logo">
                    <h1 data-en="Cement Kiln Design Calculator" data-ar="حاسبة تصميم أفران الأسمنت">Cement Kiln Design Calculator</h1>
                </div>
                <div class="header-controls">
                    <div class="language-switch">
                        <button class="lang-btn active" id="lang-en">English</button>
                        <button class="lang-btn" id="lang-ar">العربية</button>
                    </div>
                </div>
            </div>
        <a href="index.html" class="back-btn" style="position: fixed; top: 20px; right: 20px; background: var(--secondary); color: white; padding: 12px 24px; border: none; border-radius: 25px; cursor: pointer; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s; z-index: 100;"><i class="fas fa-arrow-right"></i>العودة للرئيسية</a>
</header>

        <div class="main-content">
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="hero-content">
                    <h2 data-en="Advanced Kiln Design Calculator" data-ar="حاسبة تصميم الأفران المتقدمة">Advanced Kiln Design Calculator</h2>
                    <p data-en="Comprehensive design tool for cement kiln sizing, performance analysis, and optimization using industry-standard calculations and thermal modeling" data-ar="أداة تصميم شاملة لحساب أحجام أفران الأسمنت وتحليل الأداء والتحسين باستخدام الحسابات القياسية للصناعة والنمذجة الحرارية">Comprehensive design tool for cement kiln sizing, performance analysis, and optimization using industry-standard calculations and thermal modeling</p>
                </div>
            </section>

            <!-- Company & Report Information -->
            <div class="card">
                <h2 class="section-title" data-en="Company & Report Information" data-ar="معلومات الشركة والتقرير">Company & Report Information</h2>
                <div class="grid-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="input-group">
                        <label for="company-name" data-en="Company Name" data-ar="اسم الشركة">Company Name</label>
                        <input type="text" id="company-name" placeholder="Enter company name">
                    </div>
                    <div class="input-group">
                        <label for="report-date" data-en="Report Date" data-ar="تاريخ التقرير">Report Date</label>
                        <input type="date" id="report-date">
                    </div>
                    <div class="input-group">
                        <label for="report-preparer" data-en="Report Prepared By" data-ar="معد التقرير">Report Prepared By</label>
                        <input type="text" id="report-preparer" placeholder="Enter preparer name">
                    </div>
                    <div class="input-group">
                        <label for="report-position" data-en="Preparer Position" data-ar="منصب معد التقرير">Preparer Position</label>
                        <input type="text" id="report-position" placeholder="Enter preparer position">
                    </div>
                    <div class="input-group">
                        <label for="kiln-type" data-en="Kiln Type" data-ar="نوع الفرن">Kiln Type</label>
                        <input type="text" id="kiln-type" placeholder="e.g., Wet, Dry, Semi-dry">
                    </div>
                    <div class="input-group">
                        <label for="production-date" data-en="Production Date" data-ar="تاريخ الإنتاج">Production Date</label>
                        <input type="date" id="production-date">
                    </div>
                </div>
            </div>

            <!-- Kiln Design Parameters -->
            <div class="card">
                <h2 class="section-title" data-en="Kiln Design Parameters" data-ar="معايير تصميم الفرن">Kiln Design Parameters</h2>
                <div class="grid-3" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                    <div class="input-group">
                        <label for="kiln-diameter" data-en="Kiln Diameter (m)" data-ar="قطر الفرن (متر)">Kiln Diameter (m)</label>
                        <input type="number" id="kiln-diameter" placeholder="Enter diameter" step="0.01" min="0">
                    </div>
                    <div class="input-group">
                        <label for="kiln-length" data-en="Kiln Length (m)" data-ar="طول الفرن (متر)">Kiln Length (m)</label>
                        <input type="number" id="kiln-length" placeholder="Enter length" step="0.1" min="0">
                    </div>
                    <div class="input-group">
                        <label for="kiln-slope" data-en="Kiln Slope (%)" data-ar="ميل الفرن (%)">Kiln Slope (%)</label>
                        <input type="number" id="kiln-slope" placeholder="Enter slope" step="0.1" min="0" max="10">
                    </div>
                    <div class="input-group">
                        <label for="rotation-speed" data-en="Rotation Speed (RPM)" data-ar="سرعة الدوران (دورة/دقيقة)">Rotation Speed (RPM)</label>
                        <input type="number" id="rotation-speed" placeholder="Enter speed" step="0.1" min="0">
                    </div>
                    <div class="input-group">
                        <label for="production-rate" data-en="Production Rate (t/day)" data-ar="معدل الإنتاج (طن/يوم)">Production Rate (t/day)</label>
                        <input type="number" id="production-rate" placeholder="Enter rate" step="0.1" min="0">
                    </div>
                    <div class="input-group">
                        <label for="clinker-temp" data-en="Clinker Temperature (°C)" data-ar="درجة حرارة الكلنكر (°م)">Clinker Temperature (°C)</label>
                        <input type="number" id="clinker-temp" placeholder="Enter temperature" step="1" min="0">
                    </div>
                </div>
            </div>

            <!-- Target Settings -->
            <div class="card">
                <h2 class="section-title" data-en="Target Settings" data-ar="إعدادات الأهداف">Target Settings</h2>
                <p style="text-align: center; color: var(--text-secondary); margin-bottom: 15px;" data-en="Set your factory's specific targets for 'Good' and 'Fair' ratings." data-ar="حدد أهداف مصنعك الخاصة لتقييمات 'جيد' و 'مقبول'.">Set your factory's specific targets for 'Good' and 'Fair' ratings.</p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th data-en="KPI" data-ar="المؤشر">KPI</th>
                            <th data-en="Rating Logic" data-ar="منطق التقييم">Rating Logic</th>
                            <th data-en="Target: Good" data-ar="الهدف: جيد">Target: Good</th>
                            <th data-en="Target: Fair" data-ar="الهدف: مقبول">Target: Fair</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-en="Production Rate (t/day)" data-ar="معدل الإنتاج (طن/يوم)">Production Rate (t/day)</td>
                            <td><span data-en="Higher is Better" data-ar="الأعلى أفضل">Higher is Better</span></td>
                            <td><input type="number" id="target-production-good" value="5000" step="100"></td>
                            <td><input type="number" id="target-production-fair" value="4000" step="100"></td>
                        </tr>
                        <tr>
                            <td data-en="Fuel Consumption (kcal/kg)" data-ar="استهلاك الوقود (كيلو كالوري/كيلو)">Fuel Consumption (kcal/kg)</td>
                            <td><span data-en="Lower is Better" data-ar="الأقل أفضل">Lower is Better</span></td>
                            <td><input type="number" id="target-fuel-good" value="700" step="10"></td>
                            <td><input type="number" id="target-fuel-fair" value="750" step="10"></td>
                        </tr>
                        <tr>
                            <td data-en="Heat Efficiency (%)" data-ar="كفاءة حرارية (%)">Heat Efficiency (%)</td>
                            <td><span data-en="Higher is Better" data-ar="الأعلى أفضل">Higher is Better</span></td>
                            <td><input type="number" id="target-efficiency-good" value="65" step="1"></td>
                            <td><input type="number" id="target-efficiency-fair" value="60" step="1"></td>
                        </tr>
                        <tr>
                            <td data-en="Clinker Quality Index" data-ar="مؤشر جودة الكلنكر">Clinker Quality Index</td>
                            <td><span data-en="Higher is Better" data-ar="الأعلى أفضل">Higher is Better</span></td>
                            <td><input type="number" id="target-quality-good" value="90" step="1"></td>
                            <td><input type="number" id="target-quality-fair" value="80" step="1"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Data Input Tables -->
            <div class="card">
                <h2 class="section-title" data-en="Material & Operating Data" data-ar="بيانات المواد والتشغيل">Material & Operating Data</h2>
                
                <div class="grid-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div class="input-group">
                        <label for="fuel-type" data-en="Fuel Type" data-ar="نوع الوقود">Fuel Type</label>
                        <select id="fuel-type">
                            <option value="" data-en="Select Fuel Type" data-ar="اختر نوع الوقود">Select Fuel Type</option>
                            <option value="coal" data-en="Coal" data-ar="فحم">Coal</option>
                            <option value="gas" data-en="Natural Gas" data-ar="غاز طبيعي">Natural Gas</option>
                            <option value="oil" data-en="Heavy Oil" data-ar="زيت ثقيل">Heavy Oil</option>
                            <option value="alternative" data-en="Alternative Fuel" data-ar="وقود بديل">Alternative Fuel</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="fuel-calorific" data-en="Fuel Calorific Value (kcal/kg)" data-ar="القيمة الحرارية للوقود (كيلو كالوري/كيلو)">Fuel Calorific Value (kcal/kg)</label>
                        <input type="number" id="fuel-calorific" placeholder="Enter calorific value" step="1">
                    </div>
                    <div class="input-group">
                        <label for="raw-moisture" data-en="Raw Material Moisture (%)" data-ar="رطوبة المادة الخام (%)">Raw Material Moisture (%)</label>
                        <input type="number" id="raw-moisture" placeholder="Enter moisture content" step="0.1" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label for="excess-air" data-en="Excess Air (%)" data-ar="الهواء الزائد (%)">Excess Air (%)</label>
                        <input type="number" id="excess-air" placeholder="Enter excess air" step="0.5" min="0">
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" id="calculate-design" data-en="Calculate Design" data-ar="حساب التصميم">Calculate Design</button>
                    <button class="btn btn-warning" id="load-example" data-en="Load Example Data" data-ar="تحميل بيانات مثال">Load Example Data</button>
                    <button class="btn btn-success" id="save-data" data-en="Save Data" data-ar="حفظ البيانات">Save Data</button>
                    <button class="btn btn-secondary" id="load-data" data-ar="تحميل البيانات" data-en="Load Data">Load Data</button>
                </div>
            </div>

            <!-- Additional Notes -->
            <div class="card">
                <h2 class="section-title" data-en="Additional Notes" data-ar="ملاحظات إضافية">Additional Notes</h2>
                <div class="input-group">
                    <label for="additional-notes" data-en="Add your notes and observations here:" data-ar="أضف ملاحظاتك وتوصياتك هنا:">Add your notes and observations here:</label>
                    <textarea id="additional-notes" rows="4" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 16px; font-family: var(--font-arabic);" placeholder="Enter any additional notes, observations, or recommendations..."></textarea>
                </div>
                <small style="color: var(--text-secondary);" data-en="These notes will be included in the final report" data-ar="هذه الملاحظات ستظهر في التقرير النهائي">These notes will be included in the final report</small>
            </div>
            
            <!-- Results Section -->
            <div class="results-section" id="results-section">
                <div class="card">
                    <h2 class="section-title" data-en="Kiln Design Results" data-ar="نتائج تصميم الفرن">Kiln Design Results</h2>
                    
                    <div class="grid-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <!-- Design Specifications Table -->
                        <div>
                            <h3 class="section-heading" data-en="Design Specifications" data-ar="مواصفات التصميم">Design Specifications</h3>
                            <table class="data-table" id="design-specs-table">
                                <thead>
                                    <tr>
                                        <th data-en="Parameter" data-ar="المعامل">Parameter</th>
                                        <th data-en="Value" data-ar="القيمة">Value</th>
                                        <th data-en="Unit" data-ar="الوحدة">Unit</th>
                                    </tr>
                                </thead>
                                <tbody id="design-specs-body">
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Operating Conditions Table -->
                        <div>
                            <h3 class="section-heading" data-en="Operating Conditions" data-ar="ظروف التشغيل">Operating Conditions</h3>
                            <table class="data-table" id="operating-conditions-table">
                                <thead>
                                    <tr>
                                        <th data-en="Parameter" data-ar="المعامل">Parameter</th>
                                        <th data-en="Value" data-ar="القيمة">Value</th>
                                        <th data-en="Unit" data-ar="الوحدة">Unit</th>
                                    </tr>
                                </thead>
                                <tbody id="operating-conditions-body">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Energy Balance Table -->
                    <div style="margin-top: 30px;">
                        <h3 class="section-heading" data-en="Energy Balance" data-ar="توازن الطاقة">Energy Balance</h3>
                        <table class="data-table" id="energy-balance-table">
                            <thead>
                                <tr>
                                    <th data-en="Energy Component" data-ar="مكون الطاقة">Energy Component</th>
                                    <th data-en="Value" data-ar="القيمة">Value</th>
                                    <th data-en="Unit" data-ar="الوحدة">Unit</th>
                                    <th data-en="Percentage" data-ar="النسبة المئوية">Percentage</th>
                                </tr>
                            </thead>
                            <tbody id="energy-balance-body">
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- KPI Cards -->
                    <div style="margin-top: 30px;">
                        <h3 class="section-heading" data-en="Key Performance Indicators" data-ar="المؤشرات الرئيسية للأداء">Key Performance Indicators</h3>
                        <div class="grid-2" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div class="kpi-card">
                                <div class="kpi-label" data-en="Production Rate" data-ar="معدل الإنتاج">Production Rate</div>
                                <div class="kpi-value" id="production-rate-value">-</div>
                                <div class="kpi-label" id="production-rate-status">-</div>
                            </div>
                            
                            <div class="kpi-card">
                                <div class="kpi-label" data-en="Specific Heat Consumption" data-ar="الاستهلاك الحراري النوعي">Specific Heat Consumption</div>
                                <div class="kpi-value" id="heat-consumption-value">-</div>
                                <div class="kpi-label" id="heat-consumption-status">-</div>
                            </div>
                            
                            <div class="kpi-card">
                                <div class="kpi-label" data-en="Kiln Efficiency" data-ar="كفاءة الفرن">Kiln Efficiency</div>
                                <div class="kpi-value" id="kiln-efficiency-value">-</div>
                                <div class="kpi-label" id="kiln-efficiency-status">-</div>
                            </div>
                            
                            <div class="kpi-card">
                                <div class="kpi-label" data-en="Clinker Quality Index" data-ar="مؤشر جودة الكلنكر">Clinker Quality Index</div>
                                <div class="kpi-value" id="clinker-quality-value">-</div>
                                <div class="kpi-label" id="clinker-quality-status">-</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Temperature Profile Chart -->
                    <div class="chart-container">
                        <canvas id="temperature-profile-chart"></canvas>
                    </div>
                    
                    <!-- Recommendations -->
                    <div class="recommendations">
                        <h3 class="section-heading" data-en="Recommendations" data-ar="التوصيات">Recommendations</h3>
                        <div id="recommendations-content"></div>
                    </div>
                    
                    <div class="button-group no-print">
                        <button class="btn btn-success" id="print-report" data-en="Print Report" data-ar="طباعة التقرير">Print Report</button>
                        <button class="btn btn-warning" id="export-pdf" data-en="Export as PDF" data-ar="تصدير كـ PDF">Export as PDF</button>
                        <button class="btn btn-secondary" id="new-analysis" data-en="New Analysis" data-ar="تحليل جديد">New Analysis</button>
                    </div>
                </div>
            </div>

            <!-- Developer Information -->
            <div class="developer-info no-print">
                <h3 data-en="System Developer" data-ar="مطور النظام">System Developer</h3>
                <p><strong data-en="Mr. Fadi M. Darwesh" data-ar="السيد فادي م. درويش">Mr. Fadi M. Darwesh</strong></p>
                <p data-en="QC & R&D Specialist" data-ar="أخصائي ضمان الجودة والبحوث والتطوير">QC & R&D Specialist</p>
                <p>asrar.cement@gmail.com</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer no-print">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4 data-en="Cement Kiln Design Calculator" data-ar="حاسبة تصميم أفران الأسمنت">Cement Kiln Design Calculator</h4>
                    <p data-en="Advanced calculation tools for cement kiln design and optimization" data-ar="أدوات حساب متقدمة لتصميم وتحسين أفران الأسمنت">Advanced calculation tools for cement kiln design and optimization</p>
                </div>
                <div class="footer-section">
                    <h4 data-en="Developer" data-ar="المطور">Developer</h4>
                    <ul>
                        <li>Mr. Fadi M. Darwesh</li>
                        <li data-en="QC & R&D Specialist" data-ar="أخصائي ضمان الجودة والبحوث والتطوير">QC & R&D Specialist</li>
                        <li>asrar.cement@gmail.com</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 data-en="Features" data-ar="المميزات">Features</h4>
                    <ul>
                        <li data-en="Kiln Sizing" data-ar="تصميم أحجام الأفران">Kiln Sizing</li>
                        <li data-en="Thermal Modeling" data-ar="النمذجة الحرارية">Thermal Modeling</li>
                        <li data-en="Energy Balance" data-ar="توازن الطاقة">Energy Balance</li>
                        <li data-en="Performance Optimization" data-ar="تحسين الأداء">Performance Optimization</li>
                    </ul>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--gray-700);">
                <p data-en="© 2025 Cement Kiln Design Calculator. All rights reserved." data-ar="© 2025 حاسبة تصميم أفران الأسمنت. جميع الحقوق محفوظة.">© 2025 Cement Kiln Design Calculator. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <i class="fas fa-cog"></i>
            <p data-en="Calculating..." data-ar="جاري الحساب...">Calculating...</p>
        </div>
    </div>

    <script>
        // Language switching functionality
        document.getElementById('lang-en').addEventListener('click', function() {
            setLanguage('en');
        });
        
        document.getElementById('lang-ar').addEventListener('click', function() {
            setLanguage('ar');
        });
        
        function setLanguage(lang) {
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            // Update text content based on data attributes
            document.querySelectorAll('[data-en]').forEach(element => {
                if (lang === 'en') {
                    element.textContent = element.getAttribute('data-en');
                } else {
                    element.textContent = element.getAttribute('data-ar');
                }
            });
            
            // Update placeholders
            document.querySelectorAll('input[placeholder], textarea[placeholder]').forEach(element => {
                const enText = element.getAttribute('data-en-placeholder');
                const arText = element.getAttribute('data-ar-placeholder');
                
                if (enText && arText) {
                    element.placeholder = lang === 'en' ? enText : arText;
                }
            });
            
            // Update direction
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
        }
        
        // Initialize with English
        setLanguage('en');
        
        // Initialize splash screen
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('splash-screen').classList.add('hidden');
            }, 2000);
            
            // Set current dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('report-date').value = today;
            document.getElementById('production-date').value = today;
        });

        // Calculate design
        document.getElementById('calculate-design').addEventListener('click', function() {
            calculateKilnDesign();
        });

        function calculateKilnDesign() {
            // Get input values
            const diameter = parseFloat(document.getElementById('kiln-diameter').value);
            const length = parseFloat(document.getElementById('kiln-length').value);
            const slope = parseFloat(document.getElementById('kiln-slope').value);
            const rotationSpeed = parseFloat(document.getElementById('rotation-speed').value);
            const productionRate = parseFloat(document.getElementById('production-rate').value);
            const clinkerTemp = parseFloat(document.getElementById('clinker-temp').value);
            const fuelCalorific = parseFloat(document.getElementById('fuel-calorific').value);
            const rawMoisture = parseFloat(document.getElementById('raw-moisture').value);
            const excessAir = parseFloat(document.getElementById('excess-air').value);
            
            // Validate inputs
            if (isNaN(diameter) || isNaN(length) || isNaN(productionRate)) {
                alert('Please enter required values: Diameter, Length, and Production Rate');
                return;
            }
            
            // Show loading
            document.getElementById('loading-overlay').classList.remove('hidden');
            
            // Simulate calculation delay
            setTimeout(() => {
                const results = performKilnCalculations({
                    diameter,
                    length,
                    slope,
                    rotationSpeed,
                    productionRate,
                    clinkerTemp,
                    fuelCalorific,
                    rawMoisture,
                    excessAir
                });
                
                document.getElementById('loading-overlay').classList.add('hidden');
                displayResults(results);
                document.getElementById('results-section').style.display = 'block';
            }, 1000);
        }

        function performKilnCalculations(inputs) {
            const {
                diameter,
                length,
                slope,
                rotationSpeed,
                productionRate,
                clinkerTemp,
                fuelCalorific,
                rawMoisture,
                excessAir
            } = inputs;
            
            // Basic calculations
            const kilnVolume = Math.PI * Math.pow(diameter/2, 2) * length; // m³
            const volumetricLoading = productionRate / kilnVolume; // t/day/m³
            
            // Heat calculations (simplified)
            const sensibleHeatRaw = 0.25 * rawMoisture * productionRate; // kcal/kg
            const sensibleHeatClinker = 0.25 * clinkerTemp * productionRate; // kcal/kg
            const totalSensibleHeat = (sensibleHeatRaw + sensibleHeatClinker) * productionRate;
            
            // Fuel consumption calculation
            const theoreticalHeat = totalSensibleHeat / productionRate;
            const heatLoss = theoreticalHeat * 0.15; // 15% heat loss
            const totalHeatRequired = theoreticalHeat + heatLoss;
            const specificHeatConsumption = fuelCalorific > 0 ? totalHeatRequired / productionRate : null;
            
            // Kiln efficiency
            const heatEfficiency = fuelCalorific > 0 ? (totalSensibleHeat / (totalHeatRequired * fuelCalorific)) * 100 : null;
            
            // Clinker quality index (simplified)
            const qualityIndex = heatEfficiency ? Math.min(100, heatEfficiency * 1.2) : null;
            
            // Material retention time (simplified)
            const retentionTime = length / (rotationSpeed * 0.1) / 60; // minutes
            
            return {
                designSpecs: [
                    { param: 'Kiln Volume', value: kilnVolume.toFixed(1), unit: 'm³' },
                    { param: 'Volumetric Loading', value: volumetricLoading.toFixed(2), unit: 't/day/m³' },
                    { param: 'Retention Time', value: retentionTime.toFixed(1), unit: 'min' },
                    { param: 'L/D Ratio', value: (length/diameter).toFixed(2), unit: '-' }
                ],
                operatingConditions: [
                    { param: 'Material Feed Rate', value: productionRate.toFixed(1), unit: 't/day' },
                    { param: 'Kiln Slope', value: slope ? slope.toFixed(2) : 'N/A', unit: '%' },
                    { param: 'Rotation Speed', value: rotationSpeed ? rotationSpeed.toFixed(1) : 'N/A', unit: 'RPM' },
                    { param: 'Clinker Temperature', value: clinkerTemp ? clinkerTemp.toFixed(0) : 'N/A', unit: '°C' },
                    { param: 'Raw Material Moisture', value: rawMoisture ? rawMoisture.toFixed(1) : 'N/A', unit: '%' },
                    { param: 'Excess Air', value: excessAir ? excessAir.toFixed(1) : 'N/A', unit: '%' }
                ],
                energyBalance: [
                    { component: 'Sensible Heat (Raw)', value: sensibleHeatRaw.toFixed(1), unit: 'kcal/kg', percentage: ((sensibleHeatRaw * productionRate) / totalHeatRequired * 100).toFixed(1) },
                    { component: 'Sensible Heat (Clinker)', value: sensibleHeatClinker.toFixed(1), unit: 'kcal/kg', percentage: ((sensibleHeatClinker * productionRate) / totalHeatRequired * 100).toFixed(1) },
                    { component: 'Heat Losses', value: heatLoss.toFixed(1), unit: 'kcal/kg', percentage: (heatLoss / totalHeatRequired * 100).toFixed(1) },
                    { component: 'Total Heat Required', value: totalHeatRequired.toFixed(1), unit: 'kcal/kg', percentage: '100.0' }
                ],
                kpis: {
                    productionRate: productionRate,
                    heatConsumption: specificHeatConsumption,
                    kilnEfficiency: heatEfficiency,
                    qualityIndex: qualityIndex
                },
                temperatureProfile: generateTemperatureProfile(length, clinkerTemp)
            };
        }

        function generateTemperatureProfile(length, maxTemp) {
            const profile = [];
            const numPoints = 20;
            for (let i = 0; i <= numPoints; i++) {
                const position = (length / numPoints) * i;
                // Temperature increases from feed end to discharge end
                const temp = 20 + (maxTemp - 20) * Math.pow(i / numPoints, 1.2);
                profile.push({ position: position, temperature: temp });
            }
            return profile;
        }

        function setStatusIndicator(metric, value, goodThreshold, fairThreshold, lowerIsBetter = false) {
            const statusElement = document.getElementById(`${metric}-status`);
            let status, statusClass;
            
            if (value === null || typeof value === 'undefined' || isNaN(value)) {
                statusElement.textContent = 'N/A';
                statusElement.className = 'kpi-label';
                return;
            }

            if (lowerIsBetter) {
                if (value <= goodThreshold) {
                    status = 'Good';
                    statusClass = 'good';
                } else if (value <= fairThreshold) {
                    status = 'Fair';
                    statusClass = 'fair';
                } else {
                    status = 'Poor';
                    statusClass = 'poor';
                }
            } else {
                if (value >= goodThreshold) {
                    status = 'Good';
                    statusClass = 'good';
                } else if (value >= fairThreshold) {
                    status = 'Fair';
                    statusClass = 'fair';
                } else {
                    status = 'Poor';
                    statusClass = 'poor';
                }
            }
            
            statusElement.textContent = status;
            statusElement.className = 'kpi-label ' + statusClass;
        }

        function displayResults(results) {
            // Populate Design Specifications table
            const designSpecsBody = document.getElementById('design-specs-body');
            designSpecsBody.innerHTML = '';
            results.designSpecs.forEach(spec => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${spec.param}</td>
                    <td>${spec.value}</td>
                    <td>${spec.unit}</td>
                `;
                designSpecsBody.appendChild(row);
            });
            
            // Populate Operating Conditions table
            const operatingBody = document.getElementById('operating-conditions-body');
            operatingBody.innerHTML = '';
            results.operatingConditions.forEach(condition => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${condition.param}</td>
                    <td>${condition.value}</td>
                    <td>${condition.unit}</td>
                `;
                operatingBody.appendChild(row);
            });
            
            // Populate Energy Balance table
            const energyBody = document.getElementById('energy-balance-body');
            energyBody.innerHTML = '';
            results.energyBalance.forEach(energy => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${energy.component}</td>
                    <td>${energy.value}</td>
                    <td>${energy.unit}</td>
                    <td>${energy.percentage}%</td>
                `;
                energyBody.appendChild(row);
            });
            
            // Update KPI values
            document.getElementById('production-rate-value').textContent = results.kpis.productionRate ? results.kpis.productionRate.toFixed(1) + ' t/day' : 'N/A';
            document.getElementById('heat-consumption-value').textContent = results.kpis.heatConsumption ? results.kpis.heatConsumption.toFixed(0) + ' kcal/kg' : 'N/A';
            document.getElementById('kiln-efficiency-value').textContent = results.kpis.kilnEfficiency ? results.kpis.kilnEfficiency.toFixed(1) + '%' : 'N/A';
            document.getElementById('clinker-quality-value').textContent = results.kpis.qualityIndex ? results.kpis.qualityIndex.toFixed(1) : 'N/A';
            
            // Set KPI status indicators
            const prod_good = parseFloat(document.getElementById('target-production-good').value) || 5000;
            const prod_fair = parseFloat(document.getElementById('target-production-fair').value) || 4000;
            setStatusIndicator('production-rate', results.kpis.productionRate, prod_good, prod_fair, false);
            
            const fuel_good = parseFloat(document.getElementById('target-fuel-good').value) || 700;
            const fuel_fair = parseFloat(document.getElementById('target-fuel-fair').value) || 750;
            setStatusIndicator('heat-consumption', results.kpis.heatConsumption, fuel_good, fuel_fair, true);
            
            const eff_good = parseFloat(document.getElementById('target-efficiency-good').value) || 65;
            const eff_fair = parseFloat(document.getElementById('target-efficiency-fair').value) || 60;
            setStatusIndicator('kiln-efficiency', results.kpis.kilnEfficiency, eff_good, eff_fair, false);
            
            const qual_good = parseFloat(document.getElementById('target-quality-good').value) || 90;
            const qual_fair = parseFloat(document.getElementById('target-quality-fair').value) || 80;
            setStatusIndicator('clinker-quality', results.kpis.qualityIndex, qual_good, qual_fair, false);

            // Generate temperature profile chart
            generateTemperatureProfileChart(results.temperatureProfile);
            
            // Generate recommendations
            generateRecommendations(results);
        }

        function generateTemperatureProfileChart(profileData) {
            const ctx = document.getElementById('temperature-profile-chart').getContext('2d');
            
            if (window.tempChart) {
                window.tempChart.destroy();
            }
            
            window.tempChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Temperature Profile',
                        data: profileData.map(point => ({
                            x: point.position,
                            y: point.temperature
                        })),
                        borderColor: 'rgba(239, 68, 68, 1)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 3,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'Distance from Feed End (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Temperature (°C)'
                            },
                            min: 0
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Temperature Profile Along Kiln'
                        }
                    }
                }
            });
        }

        function generateRecommendations(results) {
            let recommendations = '';
            
            const prod_good = parseFloat(document.getElementById('target-production-good').value) || 5000;
            const fuel_good = parseFloat(document.getElementById('target-fuel-good').value) || 700;
            const eff_good = parseFloat(document.getElementById('target-efficiency-good').value) || 65;
            const qual_good = parseFloat(document.getElementById('target-quality-good').value) || 90;

            if (results.kpis.productionRate < prod_good) {
                recommendations += `<p data-en="• Production rate is below target (${prod_good} t/day). Consider optimizing feed rate or kiln dimensions." data-ar="• معدل الإنتاج أقل من الهدف (${prod_good} طن/يوم). فكر في تحسين معدل التغذية أو أبعاد الفرن.">• Production rate is below target (${prod_good} t/day). Consider optimizing feed rate or kiln dimensions.</p>`;
            }
            
            if (results.kpis.heatConsumption > fuel_good) {
                recommendations += `<p data-en="• Specific heat consumption is above target (${fuel_good} kcal/kg). Consider improving insulation or combustion efficiency." data-ar="• الاستهلاك الحراري النوعي أعلى من الهدف (${fuel_good} كيلو كالوري/كيلو). فكر في تحسين العزل أو كفاءة الاحتراق.">• Specific heat consumption is above target (${fuel_good} kcal/kg). Consider improving insulation or combustion efficiency.</p>`;
            }
            
            if (results.kpis.kilnEfficiency < eff_good) {
                recommendations += `<p data-en="• Kiln efficiency is below target (${eff_good}%). Check for heat losses and optimize operating conditions." data-ar="• كفاءة الفرن أقل من الهدف (${eff_good}%). تحقق من losses الحرارة وحسن ظروف التشغيل.">• Kiln efficiency is below target (${eff_good}%). Check for heat losses and optimize operating conditions.</p>`;
            }
            
            if (results.kpis.qualityIndex < qual_good) {
                recommendations += `<p data-en="• Clinker quality index is below target (${qual_good}). Monitor temperature profile and residence time." data-ar="• مؤشر جودة الكلنكر أقل من الهدف (${qual_good}). راقب منحنى درجة الحرارة ووقت المكوث.">• Clinker quality index is below target (${qual_good}). Monitor temperature profile and residence time.</p>`;
            }
            
            recommendations += '<p data-en="• Regularly monitor kiln shell temperature to detect hot spots." data-ar="• راقب بانتظام درجة حرارة غلاف الفرن لاكتشاف النقاط الساخنة.">• Regularly monitor kiln shell temperature to detect hot spots.</p>';
            recommendations += '<p data-en="• Maintain proper kiln alignment and roller settings." data-ar="• حافظ على المحاذاة المناسبة للفرن وضبط بكرات الدعم.">• Maintain proper kiln alignment and roller settings.</p>';
            recommendations += '<p data-en="• Optimize fuel injection system for complete combustion." data-ar="• حسن نظام حقن الوقود للاحتراق الكامل.">• Optimize fuel injection system for complete combustion.</p>';
            
            document.getElementById('recommendations-content').innerHTML = recommendations;
        }

        // Button event listeners
        document.getElementById('print-report').addEventListener('click', function() {
            window.print();
        });
        
        document.getElementById('new-analysis').addEventListener('click', function() {
            document.getElementById('results-section').style.display = 'none';
        });

        // Save/Load Data functions
        document.getElementById('save-data').addEventListener('click', function() {
            const info = {
                companyName: document.getElementById('company-name').value || '',
                reportDate: document.getElementById('report-date').value || '',
                preparedBy: document.getElementById('report-preparer').value || '',
                position: document.getElementById('report-position').value || '',
                kilnType: document.getElementById('kiln-type').value || '',
                productionDate: document.getElementById('production-date').value || '',
                notes: document.getElementById('additional-notes').value || ''
            };
            
            const kilnData = {
                diameter: document.getElementById('kiln-diameter').value || '',
                length: document.getElementById('kiln-length').value || '',
                slope: document.getElementById('kiln-slope').value || '',
                rotationSpeed: document.getElementById('rotation-speed').value || '',
                productionRate: document.getElementById('production-rate').value || '',
                clinkerTemp: document.getElementById('clinker-temp').value || '',
                fuelType: document.getElementById('fuel-type').value || '',
                fuelCalorific: document.getElementById('fuel-calorific').value || '',
                rawMoisture: document.getElementById('raw-moisture').value || '',
                excessAir: document.getElementById('excess-air').value || ''
            };
            
            const saveObj = { generalInfo: info, kilnData: kilnData };
            try {
                localStorage.setItem('kilnDesignSavedData', JSON.stringify(saveObj));
                alert('Data saved successfully!');
            } catch (e) {
                alert('Unable to save data: ' + e.message);
            }
        });
        
        document.getElementById('load-data').addEventListener('click', function() {
            const saved = localStorage.getItem('kilnDesignSavedData');
            if (!saved) {
                alert('No saved data found.');
                return;
            }
            try {
                const data = JSON.parse(saved);
                // Populate general info
                if (data.generalInfo) {
                    document.getElementById('company-name').value = data.generalInfo.companyName || '';
                    document.getElementById('report-date').value = data.generalInfo.reportDate || '';
                    document.getElementById('report-preparer').value = data.generalInfo.preparedBy || '';
                    document.getElementById('report-position').value = data.generalInfo.position || '';
                    document.getElementById('kiln-type').value = data.generalInfo.kilnType || '';
                    document.getElementById('production-date').value = data.generalInfo.productionDate || '';
                    document.getElementById('additional-notes').value = data.generalInfo.notes || '';
                }
                // Populate kiln data
                if (data.kilnData) {
                    document.getElementById('kiln-diameter').value = data.kilnData.diameter || '';
                    document.getElementById('kiln-length').value = data.kilnData.length || '';
                    document.getElementById('kiln-slope').value = data.kilnData.slope || '';
                    document.getElementById('rotation-speed').value = data.kilnData.rotationSpeed || '';
                    document.getElementById('production-rate').value = data.kilnData.productionRate || '';
                    document.getElementById('clinker-temp').value = data.kilnData.clinkerTemp || '';
                    document.getElementById('fuel-type').value = data.kilnData.fuelType || '';
                    document.getElementById('fuel-calorific').value = data.kilnData.fuelCalorific || '';
                    document.getElementById('raw-moisture').value = data.kilnData.rawMoisture || '';
                    document.getElementById('excess-air').value = data.kilnData.excessAir || '';
                }
                alert('Saved data loaded successfully.');
            } catch (e) {
                alert('Error loading saved data: ' + e.message);
            }
        });

        document.getElementById('load-example').addEventListener('click', function() {
            // Fill form fields with example data
            document.getElementById('company-name').value = 'Asrar Cement Company';
            document.getElementById('report-preparer').value = 'Engineer Ali Ahmed';
            document.getElementById('report-position').value = 'Process Engineer';
            document.getElementById('kiln-type').value = 'Dry Process';
            document.getElementById('kiln-diameter').value = '5.6';
            document.getElementById('kiln-length').value = '80';
            document.getElementById('kiln-slope').value = '3.5';
            document.getElementById('rotation-speed').value = '3.5';
            document.getElementById('production-rate').value = '5000';
            document.getElementById('clinker-temp').value = '1450';
            document.getElementById('fuel-type').value = 'coal';
            document.getElementById('fuel-calorific').value = '6500';
            document.getElementById('raw-moisture').value = '5.0';
            document.getElementById('excess-air').value = '10.0';
            document.getElementById('additional-notes').value = '• Kiln operates under normal conditions\n• Monitor shell temperature regularly\n• Optimize fuel injection for better combustion\n• Check kiln alignment monthly';
            
            alert('Example data loaded successfully! Click "Calculate Design" to see results.');
        });
    </script>
    <script src="./common.js"></script>
</body>
</html>
